<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>CausalPlayground.generators API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../CausalPlayground.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;CausalPlayground</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#SCMGenerator">SCMGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SCMGenerator.__init__">SCMGenerator</a>
                        </li>
                        <li>
                                <a class="variable" href="#SCMGenerator.seed">seed</a>
                        </li>
                        <li>
                                <a class="variable" href="#SCMGenerator.all_functions">all_functions</a>
                        </li>
                        <li>
                                <a class="function" href="#SCMGenerator.create_random">create_random</a>
                        </li>
                        <li>
                                <a class="function" href="#SCMGenerator.create_scm_from_graph">create_scm_from_graph</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CausalGraphGenerator">CausalGraphGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CausalGraphGenerator.__init__">CausalGraphGenerator</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.allow_exo_confounders">allow_exo_confounders</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.seed">seed</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.endo_vars">endo_vars</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.exo_vars">exo_vars</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.potential_causes">potential_causes</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphGenerator.fully_connected_graph">fully_connected_graph</a>
                        </li>
                        <li>
                                <a class="function" href="#CausalGraphGenerator.generate_random_graph">generate_random_graph</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CausalGraphSetGenerator">CausalGraphSetGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CausalGraphSetGenerator.__init__">CausalGraphSetGenerator</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphSetGenerator.generator">generator</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphSetGenerator.graphs">graphs</a>
                        </li>
                        <li>
                                <a class="variable" href="#CausalGraphSetGenerator.max_endo_dags">max_endo_dags</a>
                        </li>
                        <li>
                                <a class="function" href="#CausalGraphSetGenerator.generate">generate</a>
                        </li>
                        <li>
                                <a class="function" href="#CausalGraphSetGenerator.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#CausalGraphSetGenerator.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#CausalGraphSetGenerator.max_n_dags">max_n_dags</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../CausalPlayground.html">CausalPlayground</a><wbr>.generators    </h1>

                        <div class="docstring"><p>Classes for generating causal DAGs and sets of causal DAGs</p>
</div>

                        <input id="mod-generators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-generators-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;Classes for generating causal DAGs and sets of causal DAGs&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Callable</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">random</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">CausalPlayground</span> <span class="kn">import</span> <span class="n">StructuralCausalModel</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="k">class</span> <span class="nc">SCMGenerator</span><span class="p">:</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for generating SCMs&quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed for the random number generator.&quot;&quot;&quot;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of possible functions that can be generated in SCMs generated by this generator. The callable that</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">    is defined in this dictionary should return the function that is used in the SCM.&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">        Constructor for the SCM generator.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">        :param all_functions: dictionary containing possible functions that can be generated in SCMs generation.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">        :param seed: the seed for the random number generator.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span> <span class="o">=</span> <span class="n">all_functions</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">def</span> <span class="nf">create_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>                      <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>            <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">StructuralCausalModel</span><span class="p">,</span> <span class="nb">set</span><span class="p">]:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        Creates and returns a random StructualCausalModel by first generating a random graph and then randomly choosing</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        a function for each edge in the graph based on the possible functions.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        of the strings defined in `self.all_functions`.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        exogenous variables.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        :param allow_exo_distribution: true if exogenous confounders should be generated.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        :return: the random scm and the set of edges that have been removed</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="k">if</span> <span class="n">n_exo</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>            <span class="k">assert</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="s1">&#39;please provide a distribution for your exogenous variables&#39;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="n">exo_distribution_kwargs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;please provide kwargs for the distribution of your exogenous variables&#39;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="n">graph_generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">graph_generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">()</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_scm_from_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">),</span>\
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>               <span class="n">removed_edges</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="k">def</span> <span class="nf">create_scm_from_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>                              <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructuralCausalModel</span><span class="p">:</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        Generates an SCM following the structure of a given directed graph. A function is randomly chosen from</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        `possible_functions` for each edge in the graph.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        :param graph: causal graph</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        of the strings defined in &#39;self.all_functions&#39;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        exogenous variables.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="n">scm</span> <span class="o">=</span> <span class="n">StructuralCausalModel</span><span class="p">()</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="n">parents</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;endo&#39;</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>                <span class="c1"># randomly choose one of the possible functions for the current node</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>                <span class="n">current_function</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible_functions</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_endogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">[</span><span class="n">current_function</span><span class="p">](</span><span class="n">parents</span><span class="p">),</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">})</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_exogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">scm</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="k">class</span> <span class="nc">CausalGraphGenerator</span><span class="p">:</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for generating random directed acyclic graphs.&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;flag whether the generated graphs can have exogenous confounders. If False, there will be at most 1 exogenous </span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    variable per endogenous variable.&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed for the random number generator.&quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="n">endo_vars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of variable names of the endogenous variables. For the automatic generation in this class, endogenous </span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    variables will be named &#39;Xn&#39; with n ascending from 0.&quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="n">exo_vars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of variable names of the exogenous variables. For the automatic generation in this class, exogenous </span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    variables will be named &#39;Un&#39; with n ascending from 0.&quot;&quot;&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="n">potential_causes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of potential causes for each variable in the graph. This helps to manage exogenous variables and their</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    confounding effects.&quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="n">fully_connected_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fully connected graph of the endogenous variables where every endogenous node is connected to every other </span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    endogenous node. The edges from exogenous variables depend on the &#39;allow_exogenous_confounders&#39; flag.&quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        Constructor defining parameters for the randomly generated graphs.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">allow_exo_confounders</span> <span class="o">=</span> <span class="n">allow_exo_confounders</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="c1"># create var names</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)]</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;U&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exo</span><span class="p">)]</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="c1"># determine potential causes for each endogenous var</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">exo_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="k">if</span> <span class="n">allow_exo_confounders</span><span class="p">:</span>  <span class="c1"># if confounding is allowed, any node can be the parent of an endogenous var</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># else, only one exo var can be the cause of an endogenous var</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">exo_copy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[</span><span class="n">exo_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">()]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[]</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="c1"># disable self-cycles</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="k">del</span> <span class="n">exo_copy</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="c1"># create a fully-connected graph based on the confounder settings and store it for later generation</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_fully_connected_dag</span><span class="p">()</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">_make_fully_connected_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        Helper function that creates and returns a fully connected, possibly cyclic graph. In this graph the exogenous</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        variables are roots.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        :return: A fully connected, directed graph.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;exo&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">]</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;endo&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">]</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">causes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">causes</span><span class="p">]</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">graph</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">generate_random_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        Creates and returns a random nx.DiGraph either by first creating a fully connected graph or creating an Edos</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        Reny graph and then randomly deleting one edge after the other until it is acyclic.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        When generating Edos Reny graphs, exogenous variables are not supported for generation. (You can always add</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        additional nodes and edges after generation).</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        :param method: either &#39;ER&#39; to generate an Edos Reny graph, or any other string for creating a graph based on</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">                        random deletion of edges from a fully-connected graph</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        :param p: probability of an edge being added to the graph when using the ER method.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        :return: the random nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ER&#39;</span><span class="p">:</span>  <span class="c1"># create erdos reny graph</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;exogenous variables are not supported when generating ER graphs&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_er_graph</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_from_fully_connected</span><span class="p">()</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">_create_er_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">        Helper method that creates an Edos Reny graph and then deletes edges until the graph is acyclic.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">        :param p: probability of an edge being added to the graph.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        :return: the acyclic nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">fast_gnp_random_graph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="c1"># rename the nodes and types according to the fully connected graph</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="n">m</span> <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)})</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                               <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()[</span><span class="n">m</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]}</span> <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                                <span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)})</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="c1"># make acyclic</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="n">random_edge</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">random_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">random_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="c1"># compute which edges are removed</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">removed_edges</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">_create_from_fully_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        Helper method that deletes edges from the fully-connected graph until it is acyclic.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">        :return: the acyclic nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="c1"># generate fully connected graph</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="c1"># delete random edges from the endogenous subgraph until acyclic</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">removed_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="c1"># determine outgoing edges from exogenous variables</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="n">endogenous_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_exo_confounders</span><span class="p">:</span>  <span class="c1"># only delete the exogenous edges if we allow confounding</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="p">[</span><span class="n">endogenous_edges</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">]</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="c1"># delete edges until the graph is acyclic</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>            <span class="n">random_edge</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">endogenous_edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="n">removed_edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">random_edge</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="n">endogenous_edges</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">random_edge</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">random_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">random_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">removed_edges</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="k">class</span> <span class="nc">CausalGraphSetGenerator</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">    Represents a collection of unique DAGs and facilitates their bookkeeping.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">CausalGraphGenerator</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Object generating the causal graphs.&quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="n">graphs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List containing all generated graphs.&quot;&quot;&quot;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="n">max_endo_dags</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of all possible DAGs with &#39;n_endo&#39; nodes.&quot;&quot;&quot;</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Constructor to parametrize the CausalGraphSetGenerator.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="o">=</span><span class="n">n_exo</span><span class="p">,</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                                              <span class="n">allow_exo_confounders</span><span class="o">=</span><span class="n">allow_exo_confounders</span><span class="p">,</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                                              <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">=</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        Generate n distinct causal DAGs. The newly generated graphs are only added to the set of graphs, if the edges</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        that have been removed during the generation are different from all other graphs in the set. This ensures the</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        uniqueness of the generated, random graphs.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        :param n: how many DAGs to create</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        :param method: which method to use to generate the graphs.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        :param p: probability with which an edge is added if ER is used.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="c1"># check whether more DAGs are to be created then combinatorically possible. Only do this if n is not</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="c1"># too big because computation takes forever for n &gt; 20 and for such values there exist over 2.3e+72</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="c1"># different graphs</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="n">n_exo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Only &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39; graphs can be created.&#39;</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">rem_edges_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="n">resampled</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating graphs...&#39;</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">rem_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">rem_edges</span> <span class="o">==</span> <span class="n">other</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">rem_edges_list</span><span class="p">]):</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="n">resampled</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                <span class="k">continue</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>                <span class="n">rem_edges_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rem_edges</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">resampled</span><span class="p">,</span> <span class="s1">&#39;models resampled&#39;</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">):</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        Save the generated graphs to a file.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        :param filepath: path to the file.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        :param mode: mode in which to open the file.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        Load graphs from files. Warning: does not check whether the loaded graphs are unique.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        :param filepath: path to the file containing the graphs.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="c1"># Warning: doesn&#39;t check whether the loaded graphs are actually a set</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>            <span class="n">graphs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The file does not contain nx.DiGraphs&#39;</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="n">graphs</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>    <span class="k">def</span> <span class="nf">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">        Computes the maximal number of different DAGs over n_vertices nodes. Implemented as in Robinson (1973)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        :param n_vertices: number of nodes in the DAG.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        :return: max number of possible DAGs.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="n">n_vertices</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="k">elif</span> <span class="n">n_vertices</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="n">summ</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_vertices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                <span class="n">summ</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">comb</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                        <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span> <span class="o">*</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="SCMGenerator">
                            <input id="SCMGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SCMGenerator</span>:

                <label class="view-source-button" for="SCMGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SCMGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SCMGenerator-15"><a href="#SCMGenerator-15"><span class="linenos">15</span></a><span class="k">class</span> <span class="nc">SCMGenerator</span><span class="p">:</span>
</span><span id="SCMGenerator-16"><a href="#SCMGenerator-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for generating SCMs&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-17"><a href="#SCMGenerator-17"><span class="linenos">17</span></a>
</span><span id="SCMGenerator-18"><a href="#SCMGenerator-18"><span class="linenos">18</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="SCMGenerator-19"><a href="#SCMGenerator-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed for the random number generator.&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-20"><a href="#SCMGenerator-20"><span class="linenos">20</span></a>    <span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span>
</span><span id="SCMGenerator-21"><a href="#SCMGenerator-21"><span class="linenos">21</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of possible functions that can be generated in SCMs generated by this generator. The callable that</span>
</span><span id="SCMGenerator-22"><a href="#SCMGenerator-22"><span class="linenos">22</span></a><span class="sd">    is defined in this dictionary should return the function that is used in the SCM.&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-23"><a href="#SCMGenerator-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="SCMGenerator-24"><a href="#SCMGenerator-24"><span class="linenos">24</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-25"><a href="#SCMGenerator-25"><span class="linenos">25</span></a><span class="sd">        Constructor for the SCM generator.</span>
</span><span id="SCMGenerator-26"><a href="#SCMGenerator-26"><span class="linenos">26</span></a>
</span><span id="SCMGenerator-27"><a href="#SCMGenerator-27"><span class="linenos">27</span></a><span class="sd">        :param all_functions: dictionary containing possible functions that can be generated in SCMs generation.</span>
</span><span id="SCMGenerator-28"><a href="#SCMGenerator-28"><span class="linenos">28</span></a><span class="sd">        :param seed: the seed for the random number generator.</span>
</span><span id="SCMGenerator-29"><a href="#SCMGenerator-29"><span class="linenos">29</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator-30"><a href="#SCMGenerator-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="SCMGenerator-31"><a href="#SCMGenerator-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span> <span class="o">=</span> <span class="n">all_functions</span>
</span><span id="SCMGenerator-32"><a href="#SCMGenerator-32"><span class="linenos">32</span></a>
</span><span id="SCMGenerator-33"><a href="#SCMGenerator-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">create_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SCMGenerator-34"><a href="#SCMGenerator-34"><span class="linenos">34</span></a>                      <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
</span><span id="SCMGenerator-35"><a href="#SCMGenerator-35"><span class="linenos">35</span></a>            <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">StructuralCausalModel</span><span class="p">,</span> <span class="nb">set</span><span class="p">]:</span>
</span><span id="SCMGenerator-36"><a href="#SCMGenerator-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-37"><a href="#SCMGenerator-37"><span class="linenos">37</span></a><span class="sd">        Creates and returns a random StructualCausalModel by first generating a random graph and then randomly choosing</span>
</span><span id="SCMGenerator-38"><a href="#SCMGenerator-38"><span class="linenos">38</span></a><span class="sd">        a function for each edge in the graph based on the possible functions.</span>
</span><span id="SCMGenerator-39"><a href="#SCMGenerator-39"><span class="linenos">39</span></a>
</span><span id="SCMGenerator-40"><a href="#SCMGenerator-40"><span class="linenos">40</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="SCMGenerator-41"><a href="#SCMGenerator-41"><span class="linenos">41</span></a><span class="sd">        of the strings defined in `self.all_functions`.</span>
</span><span id="SCMGenerator-42"><a href="#SCMGenerator-42"><span class="linenos">42</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="SCMGenerator-43"><a href="#SCMGenerator-43"><span class="linenos">43</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="SCMGenerator-44"><a href="#SCMGenerator-44"><span class="linenos">44</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="SCMGenerator-45"><a href="#SCMGenerator-45"><span class="linenos">45</span></a><span class="sd">        exogenous variables.</span>
</span><span id="SCMGenerator-46"><a href="#SCMGenerator-46"><span class="linenos">46</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="SCMGenerator-47"><a href="#SCMGenerator-47"><span class="linenos">47</span></a><span class="sd">        :param allow_exo_distribution: true if exogenous confounders should be generated.</span>
</span><span id="SCMGenerator-48"><a href="#SCMGenerator-48"><span class="linenos">48</span></a>
</span><span id="SCMGenerator-49"><a href="#SCMGenerator-49"><span class="linenos">49</span></a><span class="sd">        :return: the random scm and the set of edges that have been removed</span>
</span><span id="SCMGenerator-50"><a href="#SCMGenerator-50"><span class="linenos">50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator-51"><a href="#SCMGenerator-51"><span class="linenos">51</span></a>        <span class="k">if</span> <span class="n">n_exo</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SCMGenerator-52"><a href="#SCMGenerator-52"><span class="linenos">52</span></a>            <span class="k">assert</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="s1">&#39;please provide a distribution for your exogenous variables&#39;</span>
</span><span id="SCMGenerator-53"><a href="#SCMGenerator-53"><span class="linenos">53</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="n">exo_distribution_kwargs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;please provide kwargs for the distribution of your exogenous variables&#39;</span>
</span><span id="SCMGenerator-54"><a href="#SCMGenerator-54"><span class="linenos">54</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator-55"><a href="#SCMGenerator-55"><span class="linenos">55</span></a>        <span class="n">graph_generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator-56"><a href="#SCMGenerator-56"><span class="linenos">56</span></a>        <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">graph_generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">()</span>
</span><span id="SCMGenerator-57"><a href="#SCMGenerator-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SCMGenerator-58"><a href="#SCMGenerator-58"><span class="linenos">58</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_scm_from_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">),</span>\
</span><span id="SCMGenerator-59"><a href="#SCMGenerator-59"><span class="linenos">59</span></a>               <span class="n">removed_edges</span>
</span><span id="SCMGenerator-60"><a href="#SCMGenerator-60"><span class="linenos">60</span></a>
</span><span id="SCMGenerator-61"><a href="#SCMGenerator-61"><span class="linenos">61</span></a>    <span class="k">def</span> <span class="nf">create_scm_from_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="SCMGenerator-62"><a href="#SCMGenerator-62"><span class="linenos">62</span></a>                              <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructuralCausalModel</span><span class="p">:</span>
</span><span id="SCMGenerator-63"><a href="#SCMGenerator-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator-64"><a href="#SCMGenerator-64"><span class="linenos">64</span></a><span class="sd">        Generates an SCM following the structure of a given directed graph. A function is randomly chosen from</span>
</span><span id="SCMGenerator-65"><a href="#SCMGenerator-65"><span class="linenos">65</span></a><span class="sd">        `possible_functions` for each edge in the graph.</span>
</span><span id="SCMGenerator-66"><a href="#SCMGenerator-66"><span class="linenos">66</span></a>
</span><span id="SCMGenerator-67"><a href="#SCMGenerator-67"><span class="linenos">67</span></a><span class="sd">        :param graph: causal graph</span>
</span><span id="SCMGenerator-68"><a href="#SCMGenerator-68"><span class="linenos">68</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="SCMGenerator-69"><a href="#SCMGenerator-69"><span class="linenos">69</span></a><span class="sd">        of the strings defined in &#39;self.all_functions&#39;</span>
</span><span id="SCMGenerator-70"><a href="#SCMGenerator-70"><span class="linenos">70</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="SCMGenerator-71"><a href="#SCMGenerator-71"><span class="linenos">71</span></a><span class="sd">        exogenous variables.</span>
</span><span id="SCMGenerator-72"><a href="#SCMGenerator-72"><span class="linenos">72</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="SCMGenerator-73"><a href="#SCMGenerator-73"><span class="linenos">73</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator-74"><a href="#SCMGenerator-74"><span class="linenos">74</span></a>        <span class="n">scm</span> <span class="o">=</span> <span class="n">StructuralCausalModel</span><span class="p">()</span>
</span><span id="SCMGenerator-75"><a href="#SCMGenerator-75"><span class="linenos">75</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator-76"><a href="#SCMGenerator-76"><span class="linenos">76</span></a>
</span><span id="SCMGenerator-77"><a href="#SCMGenerator-77"><span class="linenos">77</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="SCMGenerator-78"><a href="#SCMGenerator-78"><span class="linenos">78</span></a>            <span class="n">parents</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="SCMGenerator-79"><a href="#SCMGenerator-79"><span class="linenos">79</span></a>            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;endo&#39;</span><span class="p">:</span>
</span><span id="SCMGenerator-80"><a href="#SCMGenerator-80"><span class="linenos">80</span></a>                <span class="c1"># randomly choose one of the possible functions for the current node</span>
</span><span id="SCMGenerator-81"><a href="#SCMGenerator-81"><span class="linenos">81</span></a>                <span class="n">current_function</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible_functions</span><span class="p">)</span>
</span><span id="SCMGenerator-82"><a href="#SCMGenerator-82"><span class="linenos">82</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_endogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">[</span><span class="n">current_function</span><span class="p">](</span><span class="n">parents</span><span class="p">),</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">})</span>
</span><span id="SCMGenerator-83"><a href="#SCMGenerator-83"><span class="linenos">83</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SCMGenerator-84"><a href="#SCMGenerator-84"><span class="linenos">84</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_exogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">)</span>
</span><span id="SCMGenerator-85"><a href="#SCMGenerator-85"><span class="linenos">85</span></a>
</span><span id="SCMGenerator-86"><a href="#SCMGenerator-86"><span class="linenos">86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SCMGenerator-87"><a href="#SCMGenerator-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">scm</span>
</span></pre></div>


            <div class="docstring"><p>Class for generating SCMs</p>
</div>


                            <div id="SCMGenerator.__init__" class="classattr">
                                        <input id="SCMGenerator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SCMGenerator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span>, </span><span class="param"><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="SCMGenerator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SCMGenerator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SCMGenerator.__init__-23"><a href="#SCMGenerator.__init__-23"><span class="linenos">23</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="SCMGenerator.__init__-24"><a href="#SCMGenerator.__init__-24"><span class="linenos">24</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator.__init__-25"><a href="#SCMGenerator.__init__-25"><span class="linenos">25</span></a><span class="sd">        Constructor for the SCM generator.</span>
</span><span id="SCMGenerator.__init__-26"><a href="#SCMGenerator.__init__-26"><span class="linenos">26</span></a>
</span><span id="SCMGenerator.__init__-27"><a href="#SCMGenerator.__init__-27"><span class="linenos">27</span></a><span class="sd">        :param all_functions: dictionary containing possible functions that can be generated in SCMs generation.</span>
</span><span id="SCMGenerator.__init__-28"><a href="#SCMGenerator.__init__-28"><span class="linenos">28</span></a><span class="sd">        :param seed: the seed for the random number generator.</span>
</span><span id="SCMGenerator.__init__-29"><a href="#SCMGenerator.__init__-29"><span class="linenos">29</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator.__init__-30"><a href="#SCMGenerator.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="SCMGenerator.__init__-31"><a href="#SCMGenerator.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span> <span class="o">=</span> <span class="n">all_functions</span>
</span></pre></div>


            <div class="docstring"><p>Constructor for the SCM generator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>all_functions</strong>:  dictionary containing possible functions that can be generated in SCMs generation.</li>
<li><strong>seed</strong>:  the seed for the random number generator.</li>
</ul>
</div>


                            </div>
                            <div id="SCMGenerator.seed" class="classattr">
                                <div class="attr variable">
            <span class="name">seed</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#SCMGenerator.seed"></a>
    
            <div class="docstring"><p>Seed for the random number generator.</p>
</div>


                            </div>
                            <div id="SCMGenerator.all_functions" class="classattr">
                                <div class="attr variable">
            <span class="name">all_functions</span><span class="annotation">: Dict[str, Callable]</span>

        
    </div>
    <a class="headerlink" href="#SCMGenerator.all_functions"></a>
    
            <div class="docstring"><p>Dictionary of possible functions that can be generated in SCMs generated by this generator. The callable that
is defined in this dictionary should return the function that is used in the SCM.</p>
</div>


                            </div>
                            <div id="SCMGenerator.create_random" class="classattr">
                                        <input id="SCMGenerator.create_random-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_random</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="scm.html#StructuralCausalModel">CausalPlayground.scm.StructuralCausalModel</a></span><span class="p">,</span> <span class="nb">set</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="SCMGenerator.create_random-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SCMGenerator.create_random"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SCMGenerator.create_random-33"><a href="#SCMGenerator.create_random-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">create_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SCMGenerator.create_random-34"><a href="#SCMGenerator.create_random-34"><span class="linenos">34</span></a>                      <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>\
</span><span id="SCMGenerator.create_random-35"><a href="#SCMGenerator.create_random-35"><span class="linenos">35</span></a>            <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">StructuralCausalModel</span><span class="p">,</span> <span class="nb">set</span><span class="p">]:</span>
</span><span id="SCMGenerator.create_random-36"><a href="#SCMGenerator.create_random-36"><span class="linenos">36</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator.create_random-37"><a href="#SCMGenerator.create_random-37"><span class="linenos">37</span></a><span class="sd">        Creates and returns a random StructualCausalModel by first generating a random graph and then randomly choosing</span>
</span><span id="SCMGenerator.create_random-38"><a href="#SCMGenerator.create_random-38"><span class="linenos">38</span></a><span class="sd">        a function for each edge in the graph based on the possible functions.</span>
</span><span id="SCMGenerator.create_random-39"><a href="#SCMGenerator.create_random-39"><span class="linenos">39</span></a>
</span><span id="SCMGenerator.create_random-40"><a href="#SCMGenerator.create_random-40"><span class="linenos">40</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="SCMGenerator.create_random-41"><a href="#SCMGenerator.create_random-41"><span class="linenos">41</span></a><span class="sd">        of the strings defined in `self.all_functions`.</span>
</span><span id="SCMGenerator.create_random-42"><a href="#SCMGenerator.create_random-42"><span class="linenos">42</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="SCMGenerator.create_random-43"><a href="#SCMGenerator.create_random-43"><span class="linenos">43</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="SCMGenerator.create_random-44"><a href="#SCMGenerator.create_random-44"><span class="linenos">44</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="SCMGenerator.create_random-45"><a href="#SCMGenerator.create_random-45"><span class="linenos">45</span></a><span class="sd">        exogenous variables.</span>
</span><span id="SCMGenerator.create_random-46"><a href="#SCMGenerator.create_random-46"><span class="linenos">46</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="SCMGenerator.create_random-47"><a href="#SCMGenerator.create_random-47"><span class="linenos">47</span></a><span class="sd">        :param allow_exo_distribution: true if exogenous confounders should be generated.</span>
</span><span id="SCMGenerator.create_random-48"><a href="#SCMGenerator.create_random-48"><span class="linenos">48</span></a>
</span><span id="SCMGenerator.create_random-49"><a href="#SCMGenerator.create_random-49"><span class="linenos">49</span></a><span class="sd">        :return: the random scm and the set of edges that have been removed</span>
</span><span id="SCMGenerator.create_random-50"><a href="#SCMGenerator.create_random-50"><span class="linenos">50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator.create_random-51"><a href="#SCMGenerator.create_random-51"><span class="linenos">51</span></a>        <span class="k">if</span> <span class="n">n_exo</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SCMGenerator.create_random-52"><a href="#SCMGenerator.create_random-52"><span class="linenos">52</span></a>            <span class="k">assert</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="s1">&#39;please provide a distribution for your exogenous variables&#39;</span>
</span><span id="SCMGenerator.create_random-53"><a href="#SCMGenerator.create_random-53"><span class="linenos">53</span></a>            <span class="k">assert</span> <span class="ow">not</span> <span class="n">exo_distribution_kwargs</span> <span class="o">==</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;please provide kwargs for the distribution of your exogenous variables&#39;</span>
</span><span id="SCMGenerator.create_random-54"><a href="#SCMGenerator.create_random-54"><span class="linenos">54</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator.create_random-55"><a href="#SCMGenerator.create_random-55"><span class="linenos">55</span></a>        <span class="n">graph_generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator.create_random-56"><a href="#SCMGenerator.create_random-56"><span class="linenos">56</span></a>        <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">graph_generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">()</span>
</span><span id="SCMGenerator.create_random-57"><a href="#SCMGenerator.create_random-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SCMGenerator.create_random-58"><a href="#SCMGenerator.create_random-58"><span class="linenos">58</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_scm_from_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">),</span>\
</span><span id="SCMGenerator.create_random-59"><a href="#SCMGenerator.create_random-59"><span class="linenos">59</span></a>               <span class="n">removed_edges</span>
</span></pre></div>


            <div class="docstring"><p>Creates and returns a random StructualCausalModel by first generating a random graph and then randomly choosing
a function for each edge in the graph based on the possible functions.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>possible_functions</strong>:  list of function that can be used as causal relations. These should correspond to one
of the strings defined in <code>self.all_functions</code>.</li>
<li><strong>n_endo</strong>:  number of endogenous variables.</li>
<li><strong>n_exo</strong>:  number of exogenous variables.</li>
<li><strong>exo_distribution</strong>:  distribution of the exogenous variables. This distribution is applied to all
exogenous variables.</li>
<li><strong>exo_distribution_kwargs</strong>:  keyword arguments for the distribution of exogenous variables</li>
<li><strong>allow_exo_distribution</strong>:  true if exogenous confounders should be generated.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>the random scm and the set of edges that have been removed</p>
</blockquote>
</div>


                            </div>
                            <div id="SCMGenerator.create_scm_from_graph" class="classattr">
                                        <input id="SCMGenerator.create_scm_from_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_scm_from_graph</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">graph</span><span class="p">:</span> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">DiGraph</span>,</span><span class="param">	<span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="n"><a href="scm.html#StructuralCausalModel">CausalPlayground.scm.StructuralCausalModel</a></span>:</span></span>

                <label class="view-source-button" for="SCMGenerator.create_scm_from_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SCMGenerator.create_scm_from_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SCMGenerator.create_scm_from_graph-61"><a href="#SCMGenerator.create_scm_from_graph-61"><span class="linenos">61</span></a>    <span class="k">def</span> <span class="nf">create_scm_from_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="n">possible_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">exo_distribution</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
</span><span id="SCMGenerator.create_scm_from_graph-62"><a href="#SCMGenerator.create_scm_from_graph-62"><span class="linenos">62</span></a>                              <span class="n">exo_distribution_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructuralCausalModel</span><span class="p">:</span>
</span><span id="SCMGenerator.create_scm_from_graph-63"><a href="#SCMGenerator.create_scm_from_graph-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SCMGenerator.create_scm_from_graph-64"><a href="#SCMGenerator.create_scm_from_graph-64"><span class="linenos">64</span></a><span class="sd">        Generates an SCM following the structure of a given directed graph. A function is randomly chosen from</span>
</span><span id="SCMGenerator.create_scm_from_graph-65"><a href="#SCMGenerator.create_scm_from_graph-65"><span class="linenos">65</span></a><span class="sd">        `possible_functions` for each edge in the graph.</span>
</span><span id="SCMGenerator.create_scm_from_graph-66"><a href="#SCMGenerator.create_scm_from_graph-66"><span class="linenos">66</span></a>
</span><span id="SCMGenerator.create_scm_from_graph-67"><a href="#SCMGenerator.create_scm_from_graph-67"><span class="linenos">67</span></a><span class="sd">        :param graph: causal graph</span>
</span><span id="SCMGenerator.create_scm_from_graph-68"><a href="#SCMGenerator.create_scm_from_graph-68"><span class="linenos">68</span></a><span class="sd">        :param possible_functions: list of function that can be used as causal relations. These should correspond to one</span>
</span><span id="SCMGenerator.create_scm_from_graph-69"><a href="#SCMGenerator.create_scm_from_graph-69"><span class="linenos">69</span></a><span class="sd">        of the strings defined in &#39;self.all_functions&#39;</span>
</span><span id="SCMGenerator.create_scm_from_graph-70"><a href="#SCMGenerator.create_scm_from_graph-70"><span class="linenos">70</span></a><span class="sd">        :param exo_distribution: distribution of the exogenous variables. This distribution is applied to all</span>
</span><span id="SCMGenerator.create_scm_from_graph-71"><a href="#SCMGenerator.create_scm_from_graph-71"><span class="linenos">71</span></a><span class="sd">        exogenous variables.</span>
</span><span id="SCMGenerator.create_scm_from_graph-72"><a href="#SCMGenerator.create_scm_from_graph-72"><span class="linenos">72</span></a><span class="sd">        :param exo_distribution_kwargs: keyword arguments for the distribution of exogenous variables</span>
</span><span id="SCMGenerator.create_scm_from_graph-73"><a href="#SCMGenerator.create_scm_from_graph-73"><span class="linenos">73</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SCMGenerator.create_scm_from_graph-74"><a href="#SCMGenerator.create_scm_from_graph-74"><span class="linenos">74</span></a>        <span class="n">scm</span> <span class="o">=</span> <span class="n">StructuralCausalModel</span><span class="p">()</span>
</span><span id="SCMGenerator.create_scm_from_graph-75"><a href="#SCMGenerator.create_scm_from_graph-75"><span class="linenos">75</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="SCMGenerator.create_scm_from_graph-76"><a href="#SCMGenerator.create_scm_from_graph-76"><span class="linenos">76</span></a>
</span><span id="SCMGenerator.create_scm_from_graph-77"><a href="#SCMGenerator.create_scm_from_graph-77"><span class="linenos">77</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
</span><span id="SCMGenerator.create_scm_from_graph-78"><a href="#SCMGenerator.create_scm_from_graph-78"><span class="linenos">78</span></a>            <span class="n">parents</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="SCMGenerator.create_scm_from_graph-79"><a href="#SCMGenerator.create_scm_from_graph-79"><span class="linenos">79</span></a>            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;endo&#39;</span><span class="p">:</span>
</span><span id="SCMGenerator.create_scm_from_graph-80"><a href="#SCMGenerator.create_scm_from_graph-80"><span class="linenos">80</span></a>                <span class="c1"># randomly choose one of the possible functions for the current node</span>
</span><span id="SCMGenerator.create_scm_from_graph-81"><a href="#SCMGenerator.create_scm_from_graph-81"><span class="linenos">81</span></a>                <span class="n">current_function</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible_functions</span><span class="p">)</span>
</span><span id="SCMGenerator.create_scm_from_graph-82"><a href="#SCMGenerator.create_scm_from_graph-82"><span class="linenos">82</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_endogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_functions</span><span class="p">[</span><span class="n">current_function</span><span class="p">](</span><span class="n">parents</span><span class="p">),</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parents</span><span class="p">})</span>
</span><span id="SCMGenerator.create_scm_from_graph-83"><a href="#SCMGenerator.create_scm_from_graph-83"><span class="linenos">83</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SCMGenerator.create_scm_from_graph-84"><a href="#SCMGenerator.create_scm_from_graph-84"><span class="linenos">84</span></a>                <span class="n">scm</span><span class="o">.</span><span class="n">add_exogenous_var</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">exo_distribution</span><span class="p">,</span> <span class="n">exo_distribution_kwargs</span><span class="p">)</span>
</span><span id="SCMGenerator.create_scm_from_graph-85"><a href="#SCMGenerator.create_scm_from_graph-85"><span class="linenos">85</span></a>
</span><span id="SCMGenerator.create_scm_from_graph-86"><a href="#SCMGenerator.create_scm_from_graph-86"><span class="linenos">86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="SCMGenerator.create_scm_from_graph-87"><a href="#SCMGenerator.create_scm_from_graph-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">scm</span>
</span></pre></div>


            <div class="docstring"><p>Generates an SCM following the structure of a given directed graph. A function is randomly chosen from
<code>possible_functions</code> for each edge in the graph.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>graph</strong>:  causal graph</li>
<li><strong>possible_functions</strong>:  list of function that can be used as causal relations. These should correspond to one
of the strings defined in 'self.all_functions'</li>
<li><strong>exo_distribution</strong>:  distribution of the exogenous variables. This distribution is applied to all
exogenous variables.</li>
<li><strong>exo_distribution_kwargs</strong>:  keyword arguments for the distribution of exogenous variables</li>
</ul>
</div>


                            </div>
                </section>
                <section id="CausalGraphGenerator">
                            <input id="CausalGraphGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CausalGraphGenerator</span>:

                <label class="view-source-button" for="CausalGraphGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphGenerator-90"><a href="#CausalGraphGenerator-90"><span class="linenos"> 90</span></a><span class="k">class</span> <span class="nc">CausalGraphGenerator</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-91"><a href="#CausalGraphGenerator-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for generating random directed acyclic graphs.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-92"><a href="#CausalGraphGenerator-92"><span class="linenos"> 92</span></a>
</span><span id="CausalGraphGenerator-93"><a href="#CausalGraphGenerator-93"><span class="linenos"> 93</span></a>    <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="CausalGraphGenerator-94"><a href="#CausalGraphGenerator-94"><span class="linenos"> 94</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;flag whether the generated graphs can have exogenous confounders. If False, there will be at most 1 exogenous </span>
</span><span id="CausalGraphGenerator-95"><a href="#CausalGraphGenerator-95"><span class="linenos"> 95</span></a><span class="sd">    variable per endogenous variable.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-96"><a href="#CausalGraphGenerator-96"><span class="linenos"> 96</span></a>    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CausalGraphGenerator-97"><a href="#CausalGraphGenerator-97"><span class="linenos"> 97</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed for the random number generator.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-98"><a href="#CausalGraphGenerator-98"><span class="linenos"> 98</span></a>    <span class="n">endo_vars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-99"><a href="#CausalGraphGenerator-99"><span class="linenos"> 99</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of variable names of the endogenous variables. For the automatic generation in this class, endogenous </span>
</span><span id="CausalGraphGenerator-100"><a href="#CausalGraphGenerator-100"><span class="linenos">100</span></a><span class="sd">    variables will be named &#39;Xn&#39; with n ascending from 0.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-101"><a href="#CausalGraphGenerator-101"><span class="linenos">101</span></a>    <span class="n">exo_vars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-102"><a href="#CausalGraphGenerator-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of variable names of the exogenous variables. For the automatic generation in this class, exogenous </span>
</span><span id="CausalGraphGenerator-103"><a href="#CausalGraphGenerator-103"><span class="linenos">103</span></a><span class="sd">    variables will be named &#39;Un&#39; with n ascending from 0.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-104"><a href="#CausalGraphGenerator-104"><span class="linenos">104</span></a>    <span class="n">potential_causes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
</span><span id="CausalGraphGenerator-105"><a href="#CausalGraphGenerator-105"><span class="linenos">105</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of potential causes for each variable in the graph. This helps to manage exogenous variables and their</span>
</span><span id="CausalGraphGenerator-106"><a href="#CausalGraphGenerator-106"><span class="linenos">106</span></a><span class="sd">    confounding effects.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-107"><a href="#CausalGraphGenerator-107"><span class="linenos">107</span></a>    <span class="n">fully_connected_graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span>
</span><span id="CausalGraphGenerator-108"><a href="#CausalGraphGenerator-108"><span class="linenos">108</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fully connected graph of the endogenous variables where every endogenous node is connected to every other </span>
</span><span id="CausalGraphGenerator-109"><a href="#CausalGraphGenerator-109"><span class="linenos">109</span></a><span class="sd">    endogenous node. The edges from exogenous variables depend on the &#39;allow_exogenous_confounders&#39; flag.&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-110"><a href="#CausalGraphGenerator-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="CausalGraphGenerator-111"><a href="#CausalGraphGenerator-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-112"><a href="#CausalGraphGenerator-112"><span class="linenos">112</span></a><span class="sd">        Constructor defining parameters for the randomly generated graphs.</span>
</span><span id="CausalGraphGenerator-113"><a href="#CausalGraphGenerator-113"><span class="linenos">113</span></a>
</span><span id="CausalGraphGenerator-114"><a href="#CausalGraphGenerator-114"><span class="linenos">114</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="CausalGraphGenerator-115"><a href="#CausalGraphGenerator-115"><span class="linenos">115</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="CausalGraphGenerator-116"><a href="#CausalGraphGenerator-116"><span class="linenos">116</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="CausalGraphGenerator-117"><a href="#CausalGraphGenerator-117"><span class="linenos">117</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="CausalGraphGenerator-118"><a href="#CausalGraphGenerator-118"><span class="linenos">118</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="CausalGraphGenerator-119"><a href="#CausalGraphGenerator-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-120"><a href="#CausalGraphGenerator-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">allow_exo_confounders</span> <span class="o">=</span> <span class="n">allow_exo_confounders</span>
</span><span id="CausalGraphGenerator-121"><a href="#CausalGraphGenerator-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="CausalGraphGenerator-122"><a href="#CausalGraphGenerator-122"><span class="linenos">122</span></a>
</span><span id="CausalGraphGenerator-123"><a href="#CausalGraphGenerator-123"><span class="linenos">123</span></a>        <span class="c1"># create var names</span>
</span><span id="CausalGraphGenerator-124"><a href="#CausalGraphGenerator-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)]</span>
</span><span id="CausalGraphGenerator-125"><a href="#CausalGraphGenerator-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;U&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exo</span><span class="p">)]</span>
</span><span id="CausalGraphGenerator-126"><a href="#CausalGraphGenerator-126"><span class="linenos">126</span></a>
</span><span id="CausalGraphGenerator-127"><a href="#CausalGraphGenerator-127"><span class="linenos">127</span></a>        <span class="c1"># determine potential causes for each endogenous var</span>
</span><span id="CausalGraphGenerator-128"><a href="#CausalGraphGenerator-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CausalGraphGenerator-129"><a href="#CausalGraphGenerator-129"><span class="linenos">129</span></a>        <span class="n">exo_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-130"><a href="#CausalGraphGenerator-130"><span class="linenos">130</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-131"><a href="#CausalGraphGenerator-131"><span class="linenos">131</span></a>            <span class="k">if</span> <span class="n">allow_exo_confounders</span><span class="p">:</span>  <span class="c1"># if confounding is allowed, any node can be the parent of an endogenous var</span>
</span><span id="CausalGraphGenerator-132"><a href="#CausalGraphGenerator-132"><span class="linenos">132</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span>
</span><span id="CausalGraphGenerator-133"><a href="#CausalGraphGenerator-133"><span class="linenos">133</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># else, only one exo var can be the cause of an endogenous var</span>
</span><span id="CausalGraphGenerator-134"><a href="#CausalGraphGenerator-134"><span class="linenos">134</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">exo_copy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-135"><a href="#CausalGraphGenerator-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[</span><span class="n">exo_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">()]</span>
</span><span id="CausalGraphGenerator-136"><a href="#CausalGraphGenerator-136"><span class="linenos">136</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-137"><a href="#CausalGraphGenerator-137"><span class="linenos">137</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[]</span>
</span><span id="CausalGraphGenerator-138"><a href="#CausalGraphGenerator-138"><span class="linenos">138</span></a>            <span class="c1"># disable self-cycles</span>
</span><span id="CausalGraphGenerator-139"><a href="#CausalGraphGenerator-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-140"><a href="#CausalGraphGenerator-140"><span class="linenos">140</span></a>
</span><span id="CausalGraphGenerator-141"><a href="#CausalGraphGenerator-141"><span class="linenos">141</span></a>        <span class="k">del</span> <span class="n">exo_copy</span>
</span><span id="CausalGraphGenerator-142"><a href="#CausalGraphGenerator-142"><span class="linenos">142</span></a>        <span class="c1"># create a fully-connected graph based on the confounder settings and store it for later generation</span>
</span><span id="CausalGraphGenerator-143"><a href="#CausalGraphGenerator-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_fully_connected_dag</span><span class="p">()</span>
</span><span id="CausalGraphGenerator-144"><a href="#CausalGraphGenerator-144"><span class="linenos">144</span></a>
</span><span id="CausalGraphGenerator-145"><a href="#CausalGraphGenerator-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">_make_fully_connected_dag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-146"><a href="#CausalGraphGenerator-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-147"><a href="#CausalGraphGenerator-147"><span class="linenos">147</span></a><span class="sd">        Helper function that creates and returns a fully connected, possibly cyclic graph. In this graph the exogenous</span>
</span><span id="CausalGraphGenerator-148"><a href="#CausalGraphGenerator-148"><span class="linenos">148</span></a><span class="sd">        variables are roots.</span>
</span><span id="CausalGraphGenerator-149"><a href="#CausalGraphGenerator-149"><span class="linenos">149</span></a>
</span><span id="CausalGraphGenerator-150"><a href="#CausalGraphGenerator-150"><span class="linenos">150</span></a><span class="sd">        :return: A fully connected, directed graph.</span>
</span><span id="CausalGraphGenerator-151"><a href="#CausalGraphGenerator-151"><span class="linenos">151</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-152"><a href="#CausalGraphGenerator-152"><span class="linenos">152</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</span><span id="CausalGraphGenerator-153"><a href="#CausalGraphGenerator-153"><span class="linenos">153</span></a>        <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;exo&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-154"><a href="#CausalGraphGenerator-154"><span class="linenos">154</span></a>        <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;endo&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-155"><a href="#CausalGraphGenerator-155"><span class="linenos">155</span></a>        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">causes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="CausalGraphGenerator-156"><a href="#CausalGraphGenerator-156"><span class="linenos">156</span></a>            <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">causes</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-157"><a href="#CausalGraphGenerator-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">graph</span>
</span><span id="CausalGraphGenerator-158"><a href="#CausalGraphGenerator-158"><span class="linenos">158</span></a>
</span><span id="CausalGraphGenerator-159"><a href="#CausalGraphGenerator-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">generate_random_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
</span><span id="CausalGraphGenerator-160"><a href="#CausalGraphGenerator-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-161"><a href="#CausalGraphGenerator-161"><span class="linenos">161</span></a><span class="sd">        Creates and returns a random nx.DiGraph either by first creating a fully connected graph or creating an Edos</span>
</span><span id="CausalGraphGenerator-162"><a href="#CausalGraphGenerator-162"><span class="linenos">162</span></a><span class="sd">        Reny graph and then randomly deleting one edge after the other until it is acyclic.</span>
</span><span id="CausalGraphGenerator-163"><a href="#CausalGraphGenerator-163"><span class="linenos">163</span></a>
</span><span id="CausalGraphGenerator-164"><a href="#CausalGraphGenerator-164"><span class="linenos">164</span></a><span class="sd">        When generating Edos Reny graphs, exogenous variables are not supported for generation. (You can always add</span>
</span><span id="CausalGraphGenerator-165"><a href="#CausalGraphGenerator-165"><span class="linenos">165</span></a><span class="sd">        additional nodes and edges after generation).</span>
</span><span id="CausalGraphGenerator-166"><a href="#CausalGraphGenerator-166"><span class="linenos">166</span></a>
</span><span id="CausalGraphGenerator-167"><a href="#CausalGraphGenerator-167"><span class="linenos">167</span></a><span class="sd">        :param method: either &#39;ER&#39; to generate an Edos Reny graph, or any other string for creating a graph based on</span>
</span><span id="CausalGraphGenerator-168"><a href="#CausalGraphGenerator-168"><span class="linenos">168</span></a><span class="sd">                        random deletion of edges from a fully-connected graph</span>
</span><span id="CausalGraphGenerator-169"><a href="#CausalGraphGenerator-169"><span class="linenos">169</span></a><span class="sd">        :param p: probability of an edge being added to the graph when using the ER method.</span>
</span><span id="CausalGraphGenerator-170"><a href="#CausalGraphGenerator-170"><span class="linenos">170</span></a><span class="sd">        :return: the random nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="CausalGraphGenerator-171"><a href="#CausalGraphGenerator-171"><span class="linenos">171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-172"><a href="#CausalGraphGenerator-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ER&#39;</span><span class="p">:</span>  <span class="c1"># create erdos reny graph</span>
</span><span id="CausalGraphGenerator-173"><a href="#CausalGraphGenerator-173"><span class="linenos">173</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;exogenous variables are not supported when generating ER graphs&quot;</span>
</span><span id="CausalGraphGenerator-174"><a href="#CausalGraphGenerator-174"><span class="linenos">174</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_er_graph</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-175"><a href="#CausalGraphGenerator-175"><span class="linenos">175</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphGenerator-176"><a href="#CausalGraphGenerator-176"><span class="linenos">176</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_from_fully_connected</span><span class="p">()</span>
</span><span id="CausalGraphGenerator-177"><a href="#CausalGraphGenerator-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CausalGraphGenerator-178"><a href="#CausalGraphGenerator-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span>
</span><span id="CausalGraphGenerator-179"><a href="#CausalGraphGenerator-179"><span class="linenos">179</span></a>
</span><span id="CausalGraphGenerator-180"><a href="#CausalGraphGenerator-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">_create_er_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
</span><span id="CausalGraphGenerator-181"><a href="#CausalGraphGenerator-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-182"><a href="#CausalGraphGenerator-182"><span class="linenos">182</span></a><span class="sd">        Helper method that creates an Edos Reny graph and then deletes edges until the graph is acyclic.</span>
</span><span id="CausalGraphGenerator-183"><a href="#CausalGraphGenerator-183"><span class="linenos">183</span></a>
</span><span id="CausalGraphGenerator-184"><a href="#CausalGraphGenerator-184"><span class="linenos">184</span></a><span class="sd">        :param p: probability of an edge being added to the graph.</span>
</span><span id="CausalGraphGenerator-185"><a href="#CausalGraphGenerator-185"><span class="linenos">185</span></a><span class="sd">        :return: the acyclic nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="CausalGraphGenerator-186"><a href="#CausalGraphGenerator-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-187"><a href="#CausalGraphGenerator-187"><span class="linenos">187</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">fast_gnp_random_graph</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-188"><a href="#CausalGraphGenerator-188"><span class="linenos">188</span></a>
</span><span id="CausalGraphGenerator-189"><a href="#CausalGraphGenerator-189"><span class="linenos">189</span></a>        <span class="c1"># rename the nodes and types according to the fully connected graph</span>
</span><span id="CausalGraphGenerator-190"><a href="#CausalGraphGenerator-190"><span class="linenos">190</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">relabel_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="n">m</span> <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)})</span>
</span><span id="CausalGraphGenerator-191"><a href="#CausalGraphGenerator-191"><span class="linenos">191</span></a>        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span>
</span><span id="CausalGraphGenerator-192"><a href="#CausalGraphGenerator-192"><span class="linenos">192</span></a>                               <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">()[</span><span class="n">m</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]}</span> <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span>
</span><span id="CausalGraphGenerator-193"><a href="#CausalGraphGenerator-193"><span class="linenos">193</span></a>                                <span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)})</span>
</span><span id="CausalGraphGenerator-194"><a href="#CausalGraphGenerator-194"><span class="linenos">194</span></a>
</span><span id="CausalGraphGenerator-195"><a href="#CausalGraphGenerator-195"><span class="linenos">195</span></a>        <span class="c1"># make acyclic</span>
</span><span id="CausalGraphGenerator-196"><a href="#CausalGraphGenerator-196"><span class="linenos">196</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span><span id="CausalGraphGenerator-197"><a href="#CausalGraphGenerator-197"><span class="linenos">197</span></a>            <span class="n">random_edge</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()))</span>
</span><span id="CausalGraphGenerator-198"><a href="#CausalGraphGenerator-198"><span class="linenos">198</span></a>            <span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">random_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">random_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CausalGraphGenerator-199"><a href="#CausalGraphGenerator-199"><span class="linenos">199</span></a>
</span><span id="CausalGraphGenerator-200"><a href="#CausalGraphGenerator-200"><span class="linenos">200</span></a>        <span class="c1"># compute which edges are removed</span>
</span><span id="CausalGraphGenerator-201"><a href="#CausalGraphGenerator-201"><span class="linenos">201</span></a>        <span class="n">removed_edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span>
</span><span id="CausalGraphGenerator-202"><a href="#CausalGraphGenerator-202"><span class="linenos">202</span></a>
</span><span id="CausalGraphGenerator-203"><a href="#CausalGraphGenerator-203"><span class="linenos">203</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">removed_edges</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-204"><a href="#CausalGraphGenerator-204"><span class="linenos">204</span></a>
</span><span id="CausalGraphGenerator-205"><a href="#CausalGraphGenerator-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="nf">_create_from_fully_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
</span><span id="CausalGraphGenerator-206"><a href="#CausalGraphGenerator-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-207"><a href="#CausalGraphGenerator-207"><span class="linenos">207</span></a><span class="sd">        Helper method that deletes edges from the fully-connected graph until it is acyclic.</span>
</span><span id="CausalGraphGenerator-208"><a href="#CausalGraphGenerator-208"><span class="linenos">208</span></a>
</span><span id="CausalGraphGenerator-209"><a href="#CausalGraphGenerator-209"><span class="linenos">209</span></a><span class="sd">        :return: the acyclic nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="CausalGraphGenerator-210"><a href="#CausalGraphGenerator-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator-211"><a href="#CausalGraphGenerator-211"><span class="linenos">211</span></a>        <span class="c1"># generate fully connected graph</span>
</span><span id="CausalGraphGenerator-212"><a href="#CausalGraphGenerator-212"><span class="linenos">212</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-213"><a href="#CausalGraphGenerator-213"><span class="linenos">213</span></a>        <span class="c1"># delete random edges from the endogenous subgraph until acyclic</span>
</span><span id="CausalGraphGenerator-214"><a href="#CausalGraphGenerator-214"><span class="linenos">214</span></a>        <span class="n">removed_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="CausalGraphGenerator-215"><a href="#CausalGraphGenerator-215"><span class="linenos">215</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-216"><a href="#CausalGraphGenerator-216"><span class="linenos">216</span></a>        <span class="c1"># determine outgoing edges from exogenous variables</span>
</span><span id="CausalGraphGenerator-217"><a href="#CausalGraphGenerator-217"><span class="linenos">217</span></a>        <span class="n">endogenous_edges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-218"><a href="#CausalGraphGenerator-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_exo_confounders</span><span class="p">:</span>  <span class="c1"># only delete the exogenous edges if we allow confounding</span>
</span><span id="CausalGraphGenerator-219"><a href="#CausalGraphGenerator-219"><span class="linenos">219</span></a>            <span class="p">[</span><span class="n">endogenous_edges</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-220"><a href="#CausalGraphGenerator-220"><span class="linenos">220</span></a>
</span><span id="CausalGraphGenerator-221"><a href="#CausalGraphGenerator-221"><span class="linenos">221</span></a>        <span class="c1"># delete edges until the graph is acyclic</span>
</span><span id="CausalGraphGenerator-222"><a href="#CausalGraphGenerator-222"><span class="linenos">222</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span><span id="CausalGraphGenerator-223"><a href="#CausalGraphGenerator-223"><span class="linenos">223</span></a>            <span class="n">random_edge</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">endogenous_edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CausalGraphGenerator-224"><a href="#CausalGraphGenerator-224"><span class="linenos">224</span></a>            <span class="n">removed_edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">random_edge</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-225"><a href="#CausalGraphGenerator-225"><span class="linenos">225</span></a>            <span class="n">endogenous_edges</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">random_edge</span><span class="p">)</span>
</span><span id="CausalGraphGenerator-226"><a href="#CausalGraphGenerator-226"><span class="linenos">226</span></a>            <span class="n">graph</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">random_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">random_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CausalGraphGenerator-227"><a href="#CausalGraphGenerator-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">removed_edges</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class for generating random directed acyclic graphs.</p>
</div>


                            <div id="CausalGraphGenerator.__init__" class="classattr">
                                        <input id="CausalGraphGenerator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CausalGraphGenerator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span></span>)</span>

                <label class="view-source-button" for="CausalGraphGenerator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphGenerator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphGenerator.__init__-110"><a href="#CausalGraphGenerator.__init__-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="CausalGraphGenerator.__init__-111"><a href="#CausalGraphGenerator.__init__-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator.__init__-112"><a href="#CausalGraphGenerator.__init__-112"><span class="linenos">112</span></a><span class="sd">        Constructor defining parameters for the randomly generated graphs.</span>
</span><span id="CausalGraphGenerator.__init__-113"><a href="#CausalGraphGenerator.__init__-113"><span class="linenos">113</span></a>
</span><span id="CausalGraphGenerator.__init__-114"><a href="#CausalGraphGenerator.__init__-114"><span class="linenos">114</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="CausalGraphGenerator.__init__-115"><a href="#CausalGraphGenerator.__init__-115"><span class="linenos">115</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="CausalGraphGenerator.__init__-116"><a href="#CausalGraphGenerator.__init__-116"><span class="linenos">116</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="CausalGraphGenerator.__init__-117"><a href="#CausalGraphGenerator.__init__-117"><span class="linenos">117</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="CausalGraphGenerator.__init__-118"><a href="#CausalGraphGenerator.__init__-118"><span class="linenos">118</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="CausalGraphGenerator.__init__-119"><a href="#CausalGraphGenerator.__init__-119"><span class="linenos">119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator.__init__-120"><a href="#CausalGraphGenerator.__init__-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">allow_exo_confounders</span> <span class="o">=</span> <span class="n">allow_exo_confounders</span>
</span><span id="CausalGraphGenerator.__init__-121"><a href="#CausalGraphGenerator.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="CausalGraphGenerator.__init__-122"><a href="#CausalGraphGenerator.__init__-122"><span class="linenos">122</span></a>
</span><span id="CausalGraphGenerator.__init__-123"><a href="#CausalGraphGenerator.__init__-123"><span class="linenos">123</span></a>        <span class="c1"># create var names</span>
</span><span id="CausalGraphGenerator.__init__-124"><a href="#CausalGraphGenerator.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)]</span>
</span><span id="CausalGraphGenerator.__init__-125"><a href="#CausalGraphGenerator.__init__-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;U&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exo</span><span class="p">)]</span>
</span><span id="CausalGraphGenerator.__init__-126"><a href="#CausalGraphGenerator.__init__-126"><span class="linenos">126</span></a>
</span><span id="CausalGraphGenerator.__init__-127"><a href="#CausalGraphGenerator.__init__-127"><span class="linenos">127</span></a>        <span class="c1"># determine potential causes for each endogenous var</span>
</span><span id="CausalGraphGenerator.__init__-128"><a href="#CausalGraphGenerator.__init__-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="CausalGraphGenerator.__init__-129"><a href="#CausalGraphGenerator.__init__-129"><span class="linenos">129</span></a>        <span class="n">exo_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="CausalGraphGenerator.__init__-130"><a href="#CausalGraphGenerator.__init__-130"><span class="linenos">130</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span><span class="p">:</span>
</span><span id="CausalGraphGenerator.__init__-131"><a href="#CausalGraphGenerator.__init__-131"><span class="linenos">131</span></a>            <span class="k">if</span> <span class="n">allow_exo_confounders</span><span class="p">:</span>  <span class="c1"># if confounding is allowed, any node can be the parent of an endogenous var</span>
</span><span id="CausalGraphGenerator.__init__-132"><a href="#CausalGraphGenerator.__init__-132"><span class="linenos">132</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span>
</span><span id="CausalGraphGenerator.__init__-133"><a href="#CausalGraphGenerator.__init__-133"><span class="linenos">133</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># else, only one exo var can be the cause of an endogenous var</span>
</span><span id="CausalGraphGenerator.__init__-134"><a href="#CausalGraphGenerator.__init__-134"><span class="linenos">134</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">exo_copy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphGenerator.__init__-135"><a href="#CausalGraphGenerator.__init__-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[</span><span class="n">exo_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">()]</span>
</span><span id="CausalGraphGenerator.__init__-136"><a href="#CausalGraphGenerator.__init__-136"><span class="linenos">136</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphGenerator.__init__-137"><a href="#CausalGraphGenerator.__init__-137"><span class="linenos">137</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endo_vars</span> <span class="o">+</span> <span class="p">[]</span>
</span><span id="CausalGraphGenerator.__init__-138"><a href="#CausalGraphGenerator.__init__-138"><span class="linenos">138</span></a>            <span class="c1"># disable self-cycles</span>
</span><span id="CausalGraphGenerator.__init__-139"><a href="#CausalGraphGenerator.__init__-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">potential_causes</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="CausalGraphGenerator.__init__-140"><a href="#CausalGraphGenerator.__init__-140"><span class="linenos">140</span></a>
</span><span id="CausalGraphGenerator.__init__-141"><a href="#CausalGraphGenerator.__init__-141"><span class="linenos">141</span></a>        <span class="k">del</span> <span class="n">exo_copy</span>
</span><span id="CausalGraphGenerator.__init__-142"><a href="#CausalGraphGenerator.__init__-142"><span class="linenos">142</span></a>        <span class="c1"># create a fully-connected graph based on the confounder settings and store it for later generation</span>
</span><span id="CausalGraphGenerator.__init__-143"><a href="#CausalGraphGenerator.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fully_connected_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_fully_connected_dag</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Constructor defining parameters for the randomly generated graphs.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>n_endo</strong>:  number of endogenous variables.</li>
<li><strong>n_exo</strong>:  number of exogenous variables.</li>
<li><strong>allow_exo_confounders</strong>:  flag whether the generated graphs can have exogenous confounders. If False, there
will be at most 1 exogenous variable per endogenous variable.</li>
<li><strong>seed</strong>:  seed for the random number generator.</li>
</ul>
</div>


                            </div>
                            <div id="CausalGraphGenerator.allow_exo_confounders" class="classattr">
                                <div class="attr variable">
            <span class="name">allow_exo_confounders</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.allow_exo_confounders"></a>
    
            <div class="docstring"><p>flag whether the generated graphs can have exogenous confounders. If False, there will be at most 1 exogenous 
variable per endogenous variable.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.seed" class="classattr">
                                <div class="attr variable">
            <span class="name">seed</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.seed"></a>
    
            <div class="docstring"><p>Seed for the random number generator.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.endo_vars" class="classattr">
                                <div class="attr variable">
            <span class="name">endo_vars</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.endo_vars"></a>
    
            <div class="docstring"><p>List of variable names of the endogenous variables. For the automatic generation in this class, endogenous 
variables will be named 'Xn' with n ascending from 0.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.exo_vars" class="classattr">
                                <div class="attr variable">
            <span class="name">exo_vars</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.exo_vars"></a>
    
            <div class="docstring"><p>List of variable names of the exogenous variables. For the automatic generation in this class, exogenous 
variables will be named 'Un' with n ascending from 0.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.potential_causes" class="classattr">
                                <div class="attr variable">
            <span class="name">potential_causes</span><span class="annotation">: Dict[str, List[str]]</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.potential_causes"></a>
    
            <div class="docstring"><p>Dictionary of potential causes for each variable in the graph. This helps to manage exogenous variables and their
confounding effects.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.fully_connected_graph" class="classattr">
                                <div class="attr variable">
            <span class="name">fully_connected_graph</span><span class="annotation">: networkx.classes.digraph.DiGraph</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphGenerator.fully_connected_graph"></a>
    
            <div class="docstring"><p>Fully connected graph of the endogenous variables where every endogenous node is connected to every other 
endogenous node. The edges from exogenous variables depend on the 'allow_exogenous_confounders' flag.</p>
</div>


                            </div>
                            <div id="CausalGraphGenerator.generate_random_graph" class="classattr">
                                        <input id="CausalGraphGenerator.generate_random_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_random_graph</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="CausalGraphGenerator.generate_random_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphGenerator.generate_random_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphGenerator.generate_random_graph-159"><a href="#CausalGraphGenerator.generate_random_graph-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">generate_random_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
</span><span id="CausalGraphGenerator.generate_random_graph-160"><a href="#CausalGraphGenerator.generate_random_graph-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator.generate_random_graph-161"><a href="#CausalGraphGenerator.generate_random_graph-161"><span class="linenos">161</span></a><span class="sd">        Creates and returns a random nx.DiGraph either by first creating a fully connected graph or creating an Edos</span>
</span><span id="CausalGraphGenerator.generate_random_graph-162"><a href="#CausalGraphGenerator.generate_random_graph-162"><span class="linenos">162</span></a><span class="sd">        Reny graph and then randomly deleting one edge after the other until it is acyclic.</span>
</span><span id="CausalGraphGenerator.generate_random_graph-163"><a href="#CausalGraphGenerator.generate_random_graph-163"><span class="linenos">163</span></a>
</span><span id="CausalGraphGenerator.generate_random_graph-164"><a href="#CausalGraphGenerator.generate_random_graph-164"><span class="linenos">164</span></a><span class="sd">        When generating Edos Reny graphs, exogenous variables are not supported for generation. (You can always add</span>
</span><span id="CausalGraphGenerator.generate_random_graph-165"><a href="#CausalGraphGenerator.generate_random_graph-165"><span class="linenos">165</span></a><span class="sd">        additional nodes and edges after generation).</span>
</span><span id="CausalGraphGenerator.generate_random_graph-166"><a href="#CausalGraphGenerator.generate_random_graph-166"><span class="linenos">166</span></a>
</span><span id="CausalGraphGenerator.generate_random_graph-167"><a href="#CausalGraphGenerator.generate_random_graph-167"><span class="linenos">167</span></a><span class="sd">        :param method: either &#39;ER&#39; to generate an Edos Reny graph, or any other string for creating a graph based on</span>
</span><span id="CausalGraphGenerator.generate_random_graph-168"><a href="#CausalGraphGenerator.generate_random_graph-168"><span class="linenos">168</span></a><span class="sd">                        random deletion of edges from a fully-connected graph</span>
</span><span id="CausalGraphGenerator.generate_random_graph-169"><a href="#CausalGraphGenerator.generate_random_graph-169"><span class="linenos">169</span></a><span class="sd">        :param p: probability of an edge being added to the graph when using the ER method.</span>
</span><span id="CausalGraphGenerator.generate_random_graph-170"><a href="#CausalGraphGenerator.generate_random_graph-170"><span class="linenos">170</span></a><span class="sd">        :return: the random nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</span>
</span><span id="CausalGraphGenerator.generate_random_graph-171"><a href="#CausalGraphGenerator.generate_random_graph-171"><span class="linenos">171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphGenerator.generate_random_graph-172"><a href="#CausalGraphGenerator.generate_random_graph-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ER&#39;</span><span class="p">:</span>  <span class="c1"># create erdos reny graph</span>
</span><span id="CausalGraphGenerator.generate_random_graph-173"><a href="#CausalGraphGenerator.generate_random_graph-173"><span class="linenos">173</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;exogenous variables are not supported when generating ER graphs&quot;</span>
</span><span id="CausalGraphGenerator.generate_random_graph-174"><a href="#CausalGraphGenerator.generate_random_graph-174"><span class="linenos">174</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_er_graph</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="CausalGraphGenerator.generate_random_graph-175"><a href="#CausalGraphGenerator.generate_random_graph-175"><span class="linenos">175</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphGenerator.generate_random_graph-176"><a href="#CausalGraphGenerator.generate_random_graph-176"><span class="linenos">176</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_from_fully_connected</span><span class="p">()</span>
</span><span id="CausalGraphGenerator.generate_random_graph-177"><a href="#CausalGraphGenerator.generate_random_graph-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CausalGraphGenerator.generate_random_graph-178"><a href="#CausalGraphGenerator.generate_random_graph-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="n">graph</span><span class="p">,</span> <span class="n">removed_edges</span>
</span></pre></div>


            <div class="docstring"><p>Creates and returns a random nx.DiGraph either by first creating a fully connected graph or creating an Edos
Reny graph and then randomly deleting one edge after the other until it is acyclic.</p>

<p>When generating Edos Reny graphs, exogenous variables are not supported for generation. (You can always add
additional nodes and edges after generation).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>method</strong>:  either 'ER' to generate an Edos Reny graph, or any other string for creating a graph based on
random deletion of edges from a fully-connected graph</li>
<li><strong>p</strong>:  probability of an edge being added to the graph when using the ER method.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>the random nx.DiGraph and the set of edges that have been removed from the fully-connected graph.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="CausalGraphSetGenerator">
                            <input id="CausalGraphSetGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CausalGraphSetGenerator</span>:

                <label class="view-source-button" for="CausalGraphSetGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator-230"><a href="#CausalGraphSetGenerator-230"><span class="linenos">230</span></a><span class="k">class</span> <span class="nc">CausalGraphSetGenerator</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-231"><a href="#CausalGraphSetGenerator-231"><span class="linenos">231</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-232"><a href="#CausalGraphSetGenerator-232"><span class="linenos">232</span></a><span class="sd">    Represents a collection of unique DAGs and facilitates their bookkeeping.</span>
</span><span id="CausalGraphSetGenerator-233"><a href="#CausalGraphSetGenerator-233"><span class="linenos">233</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-234"><a href="#CausalGraphSetGenerator-234"><span class="linenos">234</span></a>
</span><span id="CausalGraphSetGenerator-235"><a href="#CausalGraphSetGenerator-235"><span class="linenos">235</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">CausalGraphGenerator</span>
</span><span id="CausalGraphSetGenerator-236"><a href="#CausalGraphSetGenerator-236"><span class="linenos">236</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Object generating the causal graphs.&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-237"><a href="#CausalGraphSetGenerator-237"><span class="linenos">237</span></a>    <span class="n">graphs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">]</span>
</span><span id="CausalGraphSetGenerator-238"><a href="#CausalGraphSetGenerator-238"><span class="linenos">238</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List containing all generated graphs.&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-239"><a href="#CausalGraphSetGenerator-239"><span class="linenos">239</span></a>    <span class="n">max_endo_dags</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CausalGraphSetGenerator-240"><a href="#CausalGraphSetGenerator-240"><span class="linenos">240</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of all possible DAGs with &#39;n_endo&#39; nodes.&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-241"><a href="#CausalGraphSetGenerator-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-242"><a href="#CausalGraphSetGenerator-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-243"><a href="#CausalGraphSetGenerator-243"><span class="linenos">243</span></a><span class="sd">        Constructor to parametrize the CausalGraphSetGenerator.</span>
</span><span id="CausalGraphSetGenerator-244"><a href="#CausalGraphSetGenerator-244"><span class="linenos">244</span></a>
</span><span id="CausalGraphSetGenerator-245"><a href="#CausalGraphSetGenerator-245"><span class="linenos">245</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="CausalGraphSetGenerator-246"><a href="#CausalGraphSetGenerator-246"><span class="linenos">246</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="CausalGraphSetGenerator-247"><a href="#CausalGraphSetGenerator-247"><span class="linenos">247</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="CausalGraphSetGenerator-248"><a href="#CausalGraphSetGenerator-248"><span class="linenos">248</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="CausalGraphSetGenerator-249"><a href="#CausalGraphSetGenerator-249"><span class="linenos">249</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="CausalGraphSetGenerator-250"><a href="#CausalGraphSetGenerator-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-251"><a href="#CausalGraphSetGenerator-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="o">=</span><span class="n">n_exo</span><span class="p">,</span>
</span><span id="CausalGraphSetGenerator-252"><a href="#CausalGraphSetGenerator-252"><span class="linenos">252</span></a>                                              <span class="n">allow_exo_confounders</span><span class="o">=</span><span class="n">allow_exo_confounders</span><span class="p">,</span>
</span><span id="CausalGraphSetGenerator-253"><a href="#CausalGraphSetGenerator-253"><span class="linenos">253</span></a>                                              <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-254"><a href="#CausalGraphSetGenerator-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator-255"><a href="#CausalGraphSetGenerator-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">=</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-256"><a href="#CausalGraphSetGenerator-256"><span class="linenos">256</span></a>
</span><span id="CausalGraphSetGenerator-257"><a href="#CausalGraphSetGenerator-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-258"><a href="#CausalGraphSetGenerator-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-259"><a href="#CausalGraphSetGenerator-259"><span class="linenos">259</span></a><span class="sd">        Generate n distinct causal DAGs. The newly generated graphs are only added to the set of graphs, if the edges</span>
</span><span id="CausalGraphSetGenerator-260"><a href="#CausalGraphSetGenerator-260"><span class="linenos">260</span></a><span class="sd">        that have been removed during the generation are different from all other graphs in the set. This ensures the</span>
</span><span id="CausalGraphSetGenerator-261"><a href="#CausalGraphSetGenerator-261"><span class="linenos">261</span></a><span class="sd">        uniqueness of the generated, random graphs.</span>
</span><span id="CausalGraphSetGenerator-262"><a href="#CausalGraphSetGenerator-262"><span class="linenos">262</span></a>
</span><span id="CausalGraphSetGenerator-263"><a href="#CausalGraphSetGenerator-263"><span class="linenos">263</span></a><span class="sd">        :param n: how many DAGs to create</span>
</span><span id="CausalGraphSetGenerator-264"><a href="#CausalGraphSetGenerator-264"><span class="linenos">264</span></a><span class="sd">        :param method: which method to use to generate the graphs.</span>
</span><span id="CausalGraphSetGenerator-265"><a href="#CausalGraphSetGenerator-265"><span class="linenos">265</span></a><span class="sd">        :param p: probability with which an edge is added if ER is used.</span>
</span><span id="CausalGraphSetGenerator-266"><a href="#CausalGraphSetGenerator-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-267"><a href="#CausalGraphSetGenerator-267"><span class="linenos">267</span></a>        <span class="c1"># check whether more DAGs are to be created then combinatorically possible. Only do this if n is not</span>
</span><span id="CausalGraphSetGenerator-268"><a href="#CausalGraphSetGenerator-268"><span class="linenos">268</span></a>        <span class="c1"># too big because computation takes forever for n &gt; 20 and for such values there exist over 2.3e+72</span>
</span><span id="CausalGraphSetGenerator-269"><a href="#CausalGraphSetGenerator-269"><span class="linenos">269</span></a>        <span class="c1"># different graphs</span>
</span><span id="CausalGraphSetGenerator-270"><a href="#CausalGraphSetGenerator-270"><span class="linenos">270</span></a>        <span class="n">n_exo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-271"><a href="#CausalGraphSetGenerator-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-272"><a href="#CausalGraphSetGenerator-272"><span class="linenos">272</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-273"><a href="#CausalGraphSetGenerator-273"><span class="linenos">273</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Only &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39; graphs can be created.&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-274"><a href="#CausalGraphSetGenerator-274"><span class="linenos">274</span></a>
</span><span id="CausalGraphSetGenerator-275"><a href="#CausalGraphSetGenerator-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator-276"><a href="#CausalGraphSetGenerator-276"><span class="linenos">276</span></a>        <span class="n">rem_edges_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator-277"><a href="#CausalGraphSetGenerator-277"><span class="linenos">277</span></a>        <span class="n">resampled</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator-278"><a href="#CausalGraphSetGenerator-278"><span class="linenos">278</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating graphs...&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-279"><a href="#CausalGraphSetGenerator-279"><span class="linenos">279</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-280"><a href="#CausalGraphSetGenerator-280"><span class="linenos">280</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-281"><a href="#CausalGraphSetGenerator-281"><span class="linenos">281</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">rem_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-282"><a href="#CausalGraphSetGenerator-282"><span class="linenos">282</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">rem_edges</span> <span class="o">==</span> <span class="n">other</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">rem_edges_list</span><span class="p">]):</span>
</span><span id="CausalGraphSetGenerator-283"><a href="#CausalGraphSetGenerator-283"><span class="linenos">283</span></a>                <span class="n">resampled</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CausalGraphSetGenerator-284"><a href="#CausalGraphSetGenerator-284"><span class="linenos">284</span></a>                <span class="k">continue</span>
</span><span id="CausalGraphSetGenerator-285"><a href="#CausalGraphSetGenerator-285"><span class="linenos">285</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-286"><a href="#CausalGraphSetGenerator-286"><span class="linenos">286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-287"><a href="#CausalGraphSetGenerator-287"><span class="linenos">287</span></a>                <span class="n">rem_edges_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rem_edges</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-288"><a href="#CausalGraphSetGenerator-288"><span class="linenos">288</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-289"><a href="#CausalGraphSetGenerator-289"><span class="linenos">289</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="CausalGraphSetGenerator-290"><a href="#CausalGraphSetGenerator-290"><span class="linenos">290</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">resampled</span><span class="p">,</span> <span class="s1">&#39;models resampled&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-291"><a href="#CausalGraphSetGenerator-291"><span class="linenos">291</span></a>
</span><span id="CausalGraphSetGenerator-292"><a href="#CausalGraphSetGenerator-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-293"><a href="#CausalGraphSetGenerator-293"><span class="linenos">293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-294"><a href="#CausalGraphSetGenerator-294"><span class="linenos">294</span></a><span class="sd">        Save the generated graphs to a file.</span>
</span><span id="CausalGraphSetGenerator-295"><a href="#CausalGraphSetGenerator-295"><span class="linenos">295</span></a>
</span><span id="CausalGraphSetGenerator-296"><a href="#CausalGraphSetGenerator-296"><span class="linenos">296</span></a><span class="sd">        :param filepath: path to the file.</span>
</span><span id="CausalGraphSetGenerator-297"><a href="#CausalGraphSetGenerator-297"><span class="linenos">297</span></a><span class="sd">        :param mode: mode in which to open the file.</span>
</span><span id="CausalGraphSetGenerator-298"><a href="#CausalGraphSetGenerator-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-299"><a href="#CausalGraphSetGenerator-299"><span class="linenos">299</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-300"><a href="#CausalGraphSetGenerator-300"><span class="linenos">300</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-301"><a href="#CausalGraphSetGenerator-301"><span class="linenos">301</span></a>
</span><span id="CausalGraphSetGenerator-302"><a href="#CausalGraphSetGenerator-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-303"><a href="#CausalGraphSetGenerator-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-304"><a href="#CausalGraphSetGenerator-304"><span class="linenos">304</span></a><span class="sd">        Load graphs from files. Warning: does not check whether the loaded graphs are unique.</span>
</span><span id="CausalGraphSetGenerator-305"><a href="#CausalGraphSetGenerator-305"><span class="linenos">305</span></a>
</span><span id="CausalGraphSetGenerator-306"><a href="#CausalGraphSetGenerator-306"><span class="linenos">306</span></a><span class="sd">        :param filepath: path to the file containing the graphs.</span>
</span><span id="CausalGraphSetGenerator-307"><a href="#CausalGraphSetGenerator-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-308"><a href="#CausalGraphSetGenerator-308"><span class="linenos">308</span></a>        <span class="c1"># Warning: doesn&#39;t check whether the loaded graphs are actually a set</span>
</span><span id="CausalGraphSetGenerator-309"><a href="#CausalGraphSetGenerator-309"><span class="linenos">309</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-310"><a href="#CausalGraphSetGenerator-310"><span class="linenos">310</span></a>            <span class="n">graphs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-311"><a href="#CausalGraphSetGenerator-311"><span class="linenos">311</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-312"><a href="#CausalGraphSetGenerator-312"><span class="linenos">312</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The file does not contain nx.DiGraphs&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-313"><a href="#CausalGraphSetGenerator-313"><span class="linenos">313</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-314"><a href="#CausalGraphSetGenerator-314"><span class="linenos">314</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="n">graphs</span>
</span><span id="CausalGraphSetGenerator-315"><a href="#CausalGraphSetGenerator-315"><span class="linenos">315</span></a>
</span><span id="CausalGraphSetGenerator-316"><a href="#CausalGraphSetGenerator-316"><span class="linenos">316</span></a>    <span class="nd">@staticmethod</span>
</span><span id="CausalGraphSetGenerator-317"><a href="#CausalGraphSetGenerator-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-318"><a href="#CausalGraphSetGenerator-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-319"><a href="#CausalGraphSetGenerator-319"><span class="linenos">319</span></a><span class="sd">        Computes the maximal number of different DAGs over n_vertices nodes. Implemented as in Robinson (1973)</span>
</span><span id="CausalGraphSetGenerator-320"><a href="#CausalGraphSetGenerator-320"><span class="linenos">320</span></a>
</span><span id="CausalGraphSetGenerator-321"><a href="#CausalGraphSetGenerator-321"><span class="linenos">321</span></a><span class="sd">        :param n_vertices: number of nodes in the DAG.</span>
</span><span id="CausalGraphSetGenerator-322"><a href="#CausalGraphSetGenerator-322"><span class="linenos">322</span></a><span class="sd">        :return: max number of possible DAGs.</span>
</span><span id="CausalGraphSetGenerator-323"><a href="#CausalGraphSetGenerator-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator-324"><a href="#CausalGraphSetGenerator-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="n">n_vertices</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-325"><a href="#CausalGraphSetGenerator-325"><span class="linenos">325</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator-326"><a href="#CausalGraphSetGenerator-326"><span class="linenos">326</span></a>        <span class="k">elif</span> <span class="n">n_vertices</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-327"><a href="#CausalGraphSetGenerator-327"><span class="linenos">327</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="CausalGraphSetGenerator-328"><a href="#CausalGraphSetGenerator-328"><span class="linenos">328</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator-329"><a href="#CausalGraphSetGenerator-329"><span class="linenos">329</span></a>            <span class="n">summ</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator-330"><a href="#CausalGraphSetGenerator-330"><span class="linenos">330</span></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_vertices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator-331"><a href="#CausalGraphSetGenerator-331"><span class="linenos">331</span></a>                <span class="n">summ</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">comb</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span>
</span><span id="CausalGraphSetGenerator-332"><a href="#CausalGraphSetGenerator-332"><span class="linenos">332</span></a>                        <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span> <span class="o">*</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator-333"><a href="#CausalGraphSetGenerator-333"><span class="linenos">333</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Represents a collection of unique DAGs and facilitates their bookkeeping.</p>
</div>


                            <div id="CausalGraphSetGenerator.__init__" class="classattr">
                                        <input id="CausalGraphSetGenerator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CausalGraphSetGenerator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span></span>)</span>

                <label class="view-source-button" for="CausalGraphSetGenerator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator.__init__-241"><a href="#CausalGraphSetGenerator.__init__-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_endo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_exo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_exo_confounders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.__init__-242"><a href="#CausalGraphSetGenerator.__init__-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.__init__-243"><a href="#CausalGraphSetGenerator.__init__-243"><span class="linenos">243</span></a><span class="sd">        Constructor to parametrize the CausalGraphSetGenerator.</span>
</span><span id="CausalGraphSetGenerator.__init__-244"><a href="#CausalGraphSetGenerator.__init__-244"><span class="linenos">244</span></a>
</span><span id="CausalGraphSetGenerator.__init__-245"><a href="#CausalGraphSetGenerator.__init__-245"><span class="linenos">245</span></a><span class="sd">        :param n_endo: number of endogenous variables.</span>
</span><span id="CausalGraphSetGenerator.__init__-246"><a href="#CausalGraphSetGenerator.__init__-246"><span class="linenos">246</span></a><span class="sd">        :param n_exo: number of exogenous variables.</span>
</span><span id="CausalGraphSetGenerator.__init__-247"><a href="#CausalGraphSetGenerator.__init__-247"><span class="linenos">247</span></a><span class="sd">        :param allow_exo_confounders: flag whether the generated graphs can have exogenous confounders. If False, there</span>
</span><span id="CausalGraphSetGenerator.__init__-248"><a href="#CausalGraphSetGenerator.__init__-248"><span class="linenos">248</span></a><span class="sd">        will be at most 1 exogenous variable per endogenous variable.</span>
</span><span id="CausalGraphSetGenerator.__init__-249"><a href="#CausalGraphSetGenerator.__init__-249"><span class="linenos">249</span></a><span class="sd">        :param seed: seed for the random number generator.</span>
</span><span id="CausalGraphSetGenerator.__init__-250"><a href="#CausalGraphSetGenerator.__init__-250"><span class="linenos">250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.__init__-251"><a href="#CausalGraphSetGenerator.__init__-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">CausalGraphGenerator</span><span class="p">(</span><span class="n">n_endo</span><span class="p">,</span> <span class="n">n_exo</span><span class="o">=</span><span class="n">n_exo</span><span class="p">,</span>
</span><span id="CausalGraphSetGenerator.__init__-252"><a href="#CausalGraphSetGenerator.__init__-252"><span class="linenos">252</span></a>                                              <span class="n">allow_exo_confounders</span><span class="o">=</span><span class="n">allow_exo_confounders</span><span class="p">,</span>
</span><span id="CausalGraphSetGenerator.__init__-253"><a href="#CausalGraphSetGenerator.__init__-253"><span class="linenos">253</span></a>                                              <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.__init__-254"><a href="#CausalGraphSetGenerator.__init__-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator.__init__-255"><a href="#CausalGraphSetGenerator.__init__-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">=</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_endo</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Constructor to parametrize the CausalGraphSetGenerator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>n_endo</strong>:  number of endogenous variables.</li>
<li><strong>n_exo</strong>:  number of exogenous variables.</li>
<li><strong>allow_exo_confounders</strong>:  flag whether the generated graphs can have exogenous confounders. If False, there
will be at most 1 exogenous variable per endogenous variable.</li>
<li><strong>seed</strong>:  seed for the random number generator.</li>
</ul>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.generator" class="classattr">
                                <div class="attr variable">
            <span class="name">generator</span><span class="annotation">: <a href="#CausalGraphGenerator">CausalGraphGenerator</a></span>

        
    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.generator"></a>
    
            <div class="docstring"><p>Object generating the causal graphs.</p>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.graphs" class="classattr">
                                <div class="attr variable">
            <span class="name">graphs</span><span class="annotation">: List[networkx.classes.digraph.DiGraph]</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.graphs"></a>
    
            <div class="docstring"><p>List containing all generated graphs.</p>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.max_endo_dags" class="classattr">
                                <div class="attr variable">
            <span class="name">max_endo_dags</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.max_endo_dags"></a>
    
            <div class="docstring"><p>Number of all possible DAGs with 'n_endo' nodes.</p>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.generate" class="classattr">
                                        <input id="CausalGraphSetGenerator.generate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CausalGraphSetGenerator.generate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.generate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator.generate-257"><a href="#CausalGraphSetGenerator.generate-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.generate-258"><a href="#CausalGraphSetGenerator.generate-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.generate-259"><a href="#CausalGraphSetGenerator.generate-259"><span class="linenos">259</span></a><span class="sd">        Generate n distinct causal DAGs. The newly generated graphs are only added to the set of graphs, if the edges</span>
</span><span id="CausalGraphSetGenerator.generate-260"><a href="#CausalGraphSetGenerator.generate-260"><span class="linenos">260</span></a><span class="sd">        that have been removed during the generation are different from all other graphs in the set. This ensures the</span>
</span><span id="CausalGraphSetGenerator.generate-261"><a href="#CausalGraphSetGenerator.generate-261"><span class="linenos">261</span></a><span class="sd">        uniqueness of the generated, random graphs.</span>
</span><span id="CausalGraphSetGenerator.generate-262"><a href="#CausalGraphSetGenerator.generate-262"><span class="linenos">262</span></a>
</span><span id="CausalGraphSetGenerator.generate-263"><a href="#CausalGraphSetGenerator.generate-263"><span class="linenos">263</span></a><span class="sd">        :param n: how many DAGs to create</span>
</span><span id="CausalGraphSetGenerator.generate-264"><a href="#CausalGraphSetGenerator.generate-264"><span class="linenos">264</span></a><span class="sd">        :param method: which method to use to generate the graphs.</span>
</span><span id="CausalGraphSetGenerator.generate-265"><a href="#CausalGraphSetGenerator.generate-265"><span class="linenos">265</span></a><span class="sd">        :param p: probability with which an edge is added if ER is used.</span>
</span><span id="CausalGraphSetGenerator.generate-266"><a href="#CausalGraphSetGenerator.generate-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.generate-267"><a href="#CausalGraphSetGenerator.generate-267"><span class="linenos">267</span></a>        <span class="c1"># check whether more DAGs are to be created then combinatorically possible. Only do this if n is not</span>
</span><span id="CausalGraphSetGenerator.generate-268"><a href="#CausalGraphSetGenerator.generate-268"><span class="linenos">268</span></a>        <span class="c1"># too big because computation takes forever for n &gt; 20 and for such values there exist over 2.3e+72</span>
</span><span id="CausalGraphSetGenerator.generate-269"><a href="#CausalGraphSetGenerator.generate-269"><span class="linenos">269</span></a>        <span class="c1"># different graphs</span>
</span><span id="CausalGraphSetGenerator.generate-270"><a href="#CausalGraphSetGenerator.generate-270"><span class="linenos">270</span></a>        <span class="n">n_exo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">exo_vars</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-271"><a href="#CausalGraphSetGenerator.generate-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.generate-272"><a href="#CausalGraphSetGenerator.generate-272"><span class="linenos">272</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-273"><a href="#CausalGraphSetGenerator.generate-273"><span class="linenos">273</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Only &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_endo_dags</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_exo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39; graphs can be created.&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-274"><a href="#CausalGraphSetGenerator.generate-274"><span class="linenos">274</span></a>
</span><span id="CausalGraphSetGenerator.generate-275"><a href="#CausalGraphSetGenerator.generate-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator.generate-276"><a href="#CausalGraphSetGenerator.generate-276"><span class="linenos">276</span></a>        <span class="n">rem_edges_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CausalGraphSetGenerator.generate-277"><a href="#CausalGraphSetGenerator.generate-277"><span class="linenos">277</span></a>        <span class="n">resampled</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator.generate-278"><a href="#CausalGraphSetGenerator.generate-278"><span class="linenos">278</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating graphs...&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-279"><a href="#CausalGraphSetGenerator.generate-279"><span class="linenos">279</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-280"><a href="#CausalGraphSetGenerator.generate-280"><span class="linenos">280</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.generate-281"><a href="#CausalGraphSetGenerator.generate-281"><span class="linenos">281</span></a>            <span class="n">graph</span><span class="p">,</span> <span class="n">rem_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">generate_random_graph</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-282"><a href="#CausalGraphSetGenerator.generate-282"><span class="linenos">282</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">rem_edges</span> <span class="o">==</span> <span class="n">other</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">rem_edges_list</span><span class="p">]):</span>
</span><span id="CausalGraphSetGenerator.generate-283"><a href="#CausalGraphSetGenerator.generate-283"><span class="linenos">283</span></a>                <span class="n">resampled</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CausalGraphSetGenerator.generate-284"><a href="#CausalGraphSetGenerator.generate-284"><span class="linenos">284</span></a>                <span class="k">continue</span>
</span><span id="CausalGraphSetGenerator.generate-285"><a href="#CausalGraphSetGenerator.generate-285"><span class="linenos">285</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.generate-286"><a href="#CausalGraphSetGenerator.generate-286"><span class="linenos">286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-287"><a href="#CausalGraphSetGenerator.generate-287"><span class="linenos">287</span></a>                <span class="n">rem_edges_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rem_edges</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-288"><a href="#CausalGraphSetGenerator.generate-288"><span class="linenos">288</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.generate-289"><a href="#CausalGraphSetGenerator.generate-289"><span class="linenos">289</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="CausalGraphSetGenerator.generate-290"><a href="#CausalGraphSetGenerator.generate-290"><span class="linenos">290</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">resampled</span><span class="p">,</span> <span class="s1">&#39;models resampled&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate n distinct causal DAGs. The newly generated graphs are only added to the set of graphs, if the edges
that have been removed during the generation are different from all other graphs in the set. This ensures the
uniqueness of the generated, random graphs.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>n</strong>:  how many DAGs to create</li>
<li><strong>method</strong>:  which method to use to generate the graphs.</li>
<li><strong>p</strong>:  probability with which an edge is added if ER is used.</li>
</ul>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.save" class="classattr">
                                        <input id="CausalGraphSetGenerator.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CausalGraphSetGenerator.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator.save-292"><a href="#CausalGraphSetGenerator.save-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;wb&#39;</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.save-293"><a href="#CausalGraphSetGenerator.save-293"><span class="linenos">293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.save-294"><a href="#CausalGraphSetGenerator.save-294"><span class="linenos">294</span></a><span class="sd">        Save the generated graphs to a file.</span>
</span><span id="CausalGraphSetGenerator.save-295"><a href="#CausalGraphSetGenerator.save-295"><span class="linenos">295</span></a>
</span><span id="CausalGraphSetGenerator.save-296"><a href="#CausalGraphSetGenerator.save-296"><span class="linenos">296</span></a><span class="sd">        :param filepath: path to the file.</span>
</span><span id="CausalGraphSetGenerator.save-297"><a href="#CausalGraphSetGenerator.save-297"><span class="linenos">297</span></a><span class="sd">        :param mode: mode in which to open the file.</span>
</span><span id="CausalGraphSetGenerator.save-298"><a href="#CausalGraphSetGenerator.save-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.save-299"><a href="#CausalGraphSetGenerator.save-299"><span class="linenos">299</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.save-300"><a href="#CausalGraphSetGenerator.save-300"><span class="linenos">300</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphs</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the generated graphs to a file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filepath</strong>:  path to the file.</li>
<li><strong>mode</strong>:  mode in which to open the file.</li>
</ul>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.load" class="classattr">
                                        <input id="CausalGraphSetGenerator.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CausalGraphSetGenerator.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator.load-302"><a href="#CausalGraphSetGenerator.load-302"><span class="linenos">302</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.load-303"><a href="#CausalGraphSetGenerator.load-303"><span class="linenos">303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.load-304"><a href="#CausalGraphSetGenerator.load-304"><span class="linenos">304</span></a><span class="sd">        Load graphs from files. Warning: does not check whether the loaded graphs are unique.</span>
</span><span id="CausalGraphSetGenerator.load-305"><a href="#CausalGraphSetGenerator.load-305"><span class="linenos">305</span></a>
</span><span id="CausalGraphSetGenerator.load-306"><a href="#CausalGraphSetGenerator.load-306"><span class="linenos">306</span></a><span class="sd">        :param filepath: path to the file containing the graphs.</span>
</span><span id="CausalGraphSetGenerator.load-307"><a href="#CausalGraphSetGenerator.load-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.load-308"><a href="#CausalGraphSetGenerator.load-308"><span class="linenos">308</span></a>        <span class="c1"># Warning: doesn&#39;t check whether the loaded graphs are actually a set</span>
</span><span id="CausalGraphSetGenerator.load-309"><a href="#CausalGraphSetGenerator.load-309"><span class="linenos">309</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.load-310"><a href="#CausalGraphSetGenerator.load-310"><span class="linenos">310</span></a>            <span class="n">graphs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.load-311"><a href="#CausalGraphSetGenerator.load-311"><span class="linenos">311</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.load-312"><a href="#CausalGraphSetGenerator.load-312"><span class="linenos">312</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The file does not contain nx.DiGraphs&#39;</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.load-313"><a href="#CausalGraphSetGenerator.load-313"><span class="linenos">313</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.load-314"><a href="#CausalGraphSetGenerator.load-314"><span class="linenos">314</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">graphs</span> <span class="o">=</span> <span class="n">graphs</span>
</span></pre></div>


            <div class="docstring"><p>Load graphs from files. Warning: does not check whether the loaded graphs are unique.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filepath</strong>:  path to the file containing the graphs.</li>
</ul>
</div>


                            </div>
                            <div id="CausalGraphSetGenerator.max_n_dags" class="classattr">
                                        <input id="CausalGraphSetGenerator.max_n_dags-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">max_n_dags</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n_vertices</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="CausalGraphSetGenerator.max_n_dags-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CausalGraphSetGenerator.max_n_dags"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CausalGraphSetGenerator.max_n_dags-316"><a href="#CausalGraphSetGenerator.max_n_dags-316"><span class="linenos">316</span></a>    <span class="nd">@staticmethod</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-317"><a href="#CausalGraphSetGenerator.max_n_dags-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-318"><a href="#CausalGraphSetGenerator.max_n_dags-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-319"><a href="#CausalGraphSetGenerator.max_n_dags-319"><span class="linenos">319</span></a><span class="sd">        Computes the maximal number of different DAGs over n_vertices nodes. Implemented as in Robinson (1973)</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-320"><a href="#CausalGraphSetGenerator.max_n_dags-320"><span class="linenos">320</span></a>
</span><span id="CausalGraphSetGenerator.max_n_dags-321"><a href="#CausalGraphSetGenerator.max_n_dags-321"><span class="linenos">321</span></a><span class="sd">        :param n_vertices: number of nodes in the DAG.</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-322"><a href="#CausalGraphSetGenerator.max_n_dags-322"><span class="linenos">322</span></a><span class="sd">        :return: max number of possible DAGs.</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-323"><a href="#CausalGraphSetGenerator.max_n_dags-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-324"><a href="#CausalGraphSetGenerator.max_n_dags-324"><span class="linenos">324</span></a>        <span class="k">if</span> <span class="n">n_vertices</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-325"><a href="#CausalGraphSetGenerator.max_n_dags-325"><span class="linenos">325</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-326"><a href="#CausalGraphSetGenerator.max_n_dags-326"><span class="linenos">326</span></a>        <span class="k">elif</span> <span class="n">n_vertices</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-327"><a href="#CausalGraphSetGenerator.max_n_dags-327"><span class="linenos">327</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-328"><a href="#CausalGraphSetGenerator.max_n_dags-328"><span class="linenos">328</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-329"><a href="#CausalGraphSetGenerator.max_n_dags-329"><span class="linenos">329</span></a>            <span class="n">summ</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-330"><a href="#CausalGraphSetGenerator.max_n_dags-330"><span class="linenos">330</span></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_vertices</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-331"><a href="#CausalGraphSetGenerator.max_n_dags-331"><span class="linenos">331</span></a>                <span class="n">summ</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">comb</span><span class="p">(</span><span class="n">n_vertices</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-332"><a href="#CausalGraphSetGenerator.max_n_dags-332"><span class="linenos">332</span></a>                        <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span> <span class="o">*</span> <span class="n">CausalGraphSetGenerator</span><span class="o">.</span><span class="n">max_n_dags</span><span class="p">(</span><span class="n">n_vertices</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span><span id="CausalGraphSetGenerator.max_n_dags-333"><a href="#CausalGraphSetGenerator.max_n_dags-333"><span class="linenos">333</span></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the maximal number of different DAGs over n_vertices nodes. Implemented as in Robinson (1973)</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>n_vertices</strong>:  number of nodes in the DAG.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>max number of possible DAGs.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>